# Abonasi Backend ‚Äî Checklist & Next Steps (MVP)

> –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2025-12-23
> –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: ~/abonasi
> API base: http://localhost:3001/api

---

## 0) –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π)

- [ ] `cd ~/abonasi/backend`
- [ ] `npm i`
- [ ] –ó–∞–ø—É—Å–∫ API: `npm run dev`
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ health:
  - [ ] `curl -s http://localhost:3001/api/health`

---

## 1) –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–°–î–ï–õ–ê–ù–û ‚úÖ)

### Git

- [x] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- [x] –ö–æ–º–º–∏—Ç—ã –∏–¥—É—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ
- [x] –¢–µ–≥–∏: `v0.0.0-bootstrap` (–µ—Å—Ç—å)

### PostgreSQL

- [x] –°–æ–∑–¥–∞–Ω–∞ –ë–î `abonasi` –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `abonasi_user`
- [x] –°—Ö–µ–º–∞: users, locations, ads, ad_photos
- [x] Seed –ª–æ–∫–∞—Ü–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω (Munich —Ä–∞–π–æ–Ω—ã –∏ —Ç.–¥.)
- [x] –¢–∞–±–ª–∏—Ü—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã —á–µ—Ä–µ–∑ `\dt`

### Backend skeleton

- [x] Express + routes
- [x] DB healthcheck
- [x] .env.example, –∫–æ–Ω—Ñ–∏–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Postgres
- [x] Nodemon dev-run

### Locations module

- [x] `GET /api/locations` (—Ñ–∏–ª—å—Ç—Ä—ã country/city)
- [x] `GET /api/locations/countries`
- [x] `GET /api/locations/cities?country=...`
- [x] `GET /api/locations/districts?country=...&city=...`
- [x] `GET /api/locations/resolve?country=...&city=...&district=...` ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç locationId

### Auth module (JWT)

- [x] `POST /api/auth/register`
- [x] `POST /api/auth/login` ‚Üí token
- [x] `GET /api/auth/me` (Bearer token)
- [x] –ü–æ–≤—Ç–æ—Ä–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí CONFLICT (–æ–∂–∏–¥–∞–µ–º–æ)

### Ads MVP

- [x] `POST /api/ads` (—Å–æ–∑–¥–∞—Ç—å draft, requires JWT)
- [x] `GET /api/ads/my` (requires JWT)
- [x] `POST /api/ads/:id/publish` (requires JWT)
- [x] `POST /api/ads/:id/stop` (requires JWT)
- [x] `GET /api/ads?locationId=...` (public feed, active only)
- [x] `PATCH /api/ads/:id` (requires JWT, —Ç–æ–ª—å–∫–æ own + —Ç–æ–ª—å–∫–æ draft)

---

## 2) Smoke-tests (–±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)

### 2.1 –ü–æ–ª—É—á–∏—Ç—å locationId

- [ ] `curl -s "http://localhost:3001/api/locations/resolve?country=Germany&city=Munich&district=Laim"`

### 2.2 –ü–æ–ª—É—á–∏—Ç—å token

- [ ] `curl -s -X POST "http://localhost:3001/api/auth/login" -H "Content-Type: application/json" -d '{"email":"alex@example.com","password":"password123"}'`

### 2.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å me

- [ ] `curl -s "http://localhost:3001/api/auth/me" -H "Authorization: Bearer <TOKEN>"`

### 2.4 Ads: draft ‚Üí patch ‚Üí publish ‚Üí feed

- [ ] `POST /api/ads` (draft)
- [ ] `PATCH /api/ads/:id` (draft only)
- [ ] `POST /api/ads/:id/publish`
- [ ] `GET /api/ads?locationId=...` (–¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è)
- [ ] (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) `POST /api/ads/:id/stop`

---

## 3) –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–≤—ã–±–∏—Ä–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

### 3.1 –ö–∞—Ä—Ç–æ—á–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–≤–æ–π)

- [ ] `GET /api/ads/:id` (public)
  - [ ] –í–µ—Ä–Ω—É—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ + location (country/city/district)
  - [ ] (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ photos (–ø–æ–∫–∞ –ø—É—Å—Ç–æ)

### 3.2 –§–æ—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π (ad_photos)

- [ ] Upload (multer) ‚Üí —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫ (–ª–æ–∫–∞–ª—å–Ω–æ)
- [ ] `POST /api/ads/:id/photos` (requires JWT, owner only)
- [ ] `DELETE /api/ads/:id/photos/:photoId` (requires JWT)
- [ ] `PATCH /api/ads/:id/photos/reorder` (requires JWT)
- [ ] –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è file_path –∏ —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ `/uploads`

### 3.3 –ü–∞–≥–∏–Ω–∞—Ü–∏—è + total count

- [ ] –î–æ–±–∞–≤–∏—Ç—å `total` –≤ feed –∏ my (–∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π endpoint)
- [ ] –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å limit/offset

### 3.4 –ö–æ–Ω—Ç—Ä–∞–∫—Ç API

- [ ] –û–±–Ω–æ–≤–∏—Ç—å `docs/API_CONTRACT.md` –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã curl –¥–ª—è –∫–∞–∂–¥–æ–≥–æ endpoint
- [ ] (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) OpenAPI –ø–æ–∑–∂–µ

---

## 4) –ê—É–¥–∏—Ç –∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ (–ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å)

### –ü–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–µ–π (2‚Äì3 –º–∏–Ω)

- [ ] `git status` (—á–∏—Å—Ç–æ?)
- [ ] `npm test` (–µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è)
- [ ] `npm run dev` + `GET /health`

### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –±–ª–æ–∫–∞ (5‚Äì10 –º–∏–Ω)

- [ ] Smoke-tests –ø–æ –±–ª–æ–∫—É
- [ ] –ö–æ–º–º–∏—Ç –∞—Ç–æ–º–∞—Ä–Ω—ã–π, –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `docs/CHANGELOG_DEV.md` (1‚Äì3 —Å—Ç—Ä–æ–∫–∏)

### Ads / –ø—Ä–∞–≤–∏–ª–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üîí –ü—Ä–∞–≤–∏–ª–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç–∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π

- **–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (status=active) –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è.**
- –õ—é–±–∞—è ‚Äú—Ä–µ–¥–∞–∫—Ü–∏—è‚Äù –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫:

  1. —Å–∏—Å—Ç–µ–º–∞ **–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä–æ–µ** –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (active ‚Üí stopped)
  2. —Å–∏—Å—Ç–µ–º–∞ **—Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤–æ–µ** –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (–Ω–æ–≤—ã–π id) —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º
  3. –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç **–Ω–æ–≤—É—é –¥–∞—Ç—É –ø—É–±–ª–∏–∫–∞—Ü–∏–∏** (published_at = now)
  4. —Ñ–æ—Ç–æ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –≤ –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ

- –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–ø–æ–¥–∞—Ç–µ–ª—è —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –æ–±—ã—á–Ω–∞—è –ø—Ä–∞–≤–∫–∞, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:

  > ‚Äú–°—Ç–∞—Ä–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ.‚Äù

- –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ (status=draft) —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é—Ç—Å—è –æ–±—ã—á–Ω—ã–º PATCH –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ id.

### –†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é (–µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –∂–∏–≤–æ–π)

- [ ] `npm audit` (–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ö–∞–æ—Ç–∏—á–Ω–æ, —Ç–æ–ª—å–∫–æ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env / —Å–µ–∫—Ä–µ—Ç—ã (–Ω–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –ª–∏)
- [ ] –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤/–æ—à–∏–±–æ–∫ –≤ dev

---

## 5) –¢–æ—á–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (—Ç–µ–≥–∏)

- [ ] `v0.0.0-bootstrap` ‚úÖ
- [ ] (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ) `v0.1.0-backend-mvp` –ø–æ—Å–ª–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ (GET /ads/:id + photos plan)

---
